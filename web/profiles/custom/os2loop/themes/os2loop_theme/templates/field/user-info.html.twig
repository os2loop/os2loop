{#
/**
 * @file
 * Implementation of user info related to content.
 *
 * Available variables:
 * - user: The user to display info about.
 * - attributes: Contains classes from calling template (optiona).
 */
#}
{# Display author if not anonymous #}
{% set image = user['#user'].id is not empty ? drupal_field('os2loop_user_image', 'user', user['#user'].id, 'compact') %}
{% set initials = user['#user'].os2loop_user_given_name.value|first ~ user['#user'].os2loop_user_family_name.value|first %}
{% set initials = (initials is not empty ? initials : 'Anonymous user'|t|first)|upper %}
<div class="d-flex align-items-center">
  <div class="user-image">
    <div>{{ image['#items'] is not empty ? image : initials }}</div>
  </div>
  <div class="user-name">
    {% if user['#user'].os2loop_user_job_title.value %}
    <div>
      {% set user_url = user['#user'].id is not empty ? url('entity.user.canonical', {'user': user['#user'].id}) : '#' %}
      <a href="{{ user_url }}">{{ user['#user'].os2loop_user_given_name.value }} {{ user['#user'].os2loop_user_family_name.value }}</a>
    </div>
    <div>
      <span class="small">{{ user['#user'].os2loop_user_job_title.value }}, {{ user['#user'].os2loop_user_place.value }}</span>
    </div>
    {% else %}
    <div>
      <p>{{ 'Anonymous user'|t }}</p>
    </div>
    {% endif %}
  </div>
  {% if attributes.hasClass('top-comment') %}
  <div class="badge badge-primary">
    {{ attributes.hasClass('correct-answer') ? 'Editorial recommendation'|t : 'Most votes'|t }}
  </div>
  {% endif %}
</div>
{% if date %}
<div class="ml-auto">
  <span class="small">{{ date|striptags|trim|slice(5, 10)|replace({'/': '-'}) }}</span>
</div>
{% endif %}
